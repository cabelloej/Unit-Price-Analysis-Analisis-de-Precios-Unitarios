STORE "INGRESE EL CODIGO DEL PRESUPUESTO ORIGEN" TO MES
DO MENSAJE WITH MES
STORE SPACE(10) TO WORIGEN
@ 23,60 GET WORIGEN
READ
IF WORIGEN = SPACE(10)
   RETURN
ENDIF
STORE UPPER(WORIGEN) TO WORIGEN
USE IPPPRESU INDEX IPPPRESU
FIND &WORIGEN
IF EOF()
   STORE "CODIGO DE PRESUPUESTO ORIGEN NO EXISTE" TO MES
   DO AVISO WITH MES
   CLOSE DATA
   CLOSE INDEX
   RETURN
ENDIF
STORE "INGRESE EL CODIGO DEL PRESUPUESTO DESTINO" TO MES
DO MENSAJE WITH MES
STORE SPACE(10) TO WDESTINO
@ 23,60 GET WDESTINO
READ
IF WDESTINO = SPACE(10)
   RETURN
ENDIF
STORE UPPER(WDESTINO) TO WDESTINO
USE IPPPRESU INDEX IPPPRESU
FIND &WDESTINO
IF .NOT. EOF()
   STORE "CODIGO DE PRESUPUESTO DESTINO YA EXISTE" TO MES
   DO AVISO WITH MES
   CLOSE DATA
   CLOSE INDEX
   RETURN
ENDIF
STORE "COMANDO EN PROGRESO..." TO MES
DO MENSAJE WITH MES
COPY STRU TO T1
USE T1
APPEND FROM IPPPRESU FOR PRECOD = WORIGEN
REPLACE PRECOD WITH WDESTINO
USE IPPPARTI
COPY STRU TO T2
USE T2
APPEND FROM IPPPARTI FOR PARPRE = WORIGEN
REPLACE ALL PARPRE WITH WDESTINO
USE IPPMATER
COPY STRU TO T3
USE T3
APPEND FROM IPPMATER FOR MATERPRE = WORIGEN
REPLACE ALL MATERPRE WITH WDESTINO
USE IPPEQUIP
COPY STRU TO T4
USE T4
APPEND FROM IPPEQUIP FOR EQUIPPRE = WORIGEN
REPLACE ALL EQUIPPRE WITH WDESTINO
USE IPPMDO
COPY STRU TO T5
USE T5
APPEND FROM IPPMDO FOR MOBRAPRE = WORIGEN
REPLACE ALL MOBRAPRE WITH WDESTINO
USE IPPPARDE
COPY STRU TO T6
USE T6
APPEND FROM IPPPARDE FOR PRESU = WORIGEN
REPLACE ALL PRESU WITH WDESTINO

USE IPPPRESU INDEX IPPPRESU
APPEND FROM T1
USE IPPPARTI INDEX IPPPART1, IPPPART2
APPEND FROM T2
USE IPPMATER INDEX IPPMATER
APPEND FROM T3
USE IPPEQUIP INDEX IPPEQUIP
APPEND FROM T4
USE IPPMDO   INDEX IPPMDO
APPEND FROM T5
USE IPPPARDE INDEX IPPPARDE
APPEND FROM T6
CLOSE DATA
CLOSE INDEX

DELETE FILE T1.DBF
DELETE FILE T2.DBF
DELETE FILE T3.DBF
DELETE FILE T4.DBF
DELETE FILE T5.DBF
DELETE FILE T6.DBF
RETURN
